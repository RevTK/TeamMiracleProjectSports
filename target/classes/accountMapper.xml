<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tm.nmp.account.AccountMapper">

	<select id="idCheck" parameterType="String" resultType="int">
		select count(*) from tb_user where id = #{id}
	</select>
	
	<insert id="regAccount" parameterType="com.tm.nmp.account.AccountDTO">
		BEGIN
		insert into tb_user
		(id, nickname, join_type, email, phone, gender, birthday)
		values
		(#{id}, #{nickname}, #{join_type}, #{email}, #{phone, jdbcType=VARCHAR}, #{gender}, #{birthday, jdbcType=VARCHAR});

		insert into tb_password
		(user_id, password, salt)
		values
		(#{id}, #{password}, #{salt, jdbcType=VARCHAR});
		END;
	</insert>
	
	<insert id="regFavoriteClub" parameterType="list">
		insert all
		<foreach collection="list" item="item">
			into tb_favorite_club
			values
			(#{item.user_id}, #{item.club_id})
		</foreach>
		select * from dual
	</insert>

	<select id="accountLogin" resultType="com.tm.nmp.account.AccountDTO">
		select u.*, p.password from tb_user u, tb_password p
		where u.id = p.user_id and u.id = #{id}
	</select>
	
	
	
	
	<select id="showAccount" resultType="com.tm.nmp.account.AccountDTO">
	select * from member where member_id = #{member_id}
	</select>
	
	<select id="searchId"
		parameterType="com.tm.nmp.account.AccountDTO"
		resultType="com.tm.nmp.account.AccountDTO">
		select * from account where ac_name = #{ac_name} and
		ac_email = #{ac_email}
	</select>

	<update id="changePwDo"
		parameterType="com.tm.nmp.account.AccountDTO">
		update account set ac_pw = #{ac_pw} where ac_id=
		#{ac_id}
	</update>

	<select id="socialIdCheck" resultType="int">
		select count(*) from
		member where member_id = #{member_id} and
		member_reg_type =
		#{member_reg_type}
	</select>

	<update id="accountUpdate"
		parameterType="com.tm.nmp.account.AccountDTO">
		update account set ac_pw = #{ac_pw}, ac_name =
		#{ac_name},ac_nick = #{ac_nick}, ac_addr =
		#{ac_addr}, ac_email =
		#{ac_email} where ac_id = #{ac_id}
	</update>

	<delete id="accountDelete"
		parameterType="com.tm.nmp.account.AccountDTO">
		delete from account where ac_id = #{ac_id}
	</delete>
	
	<select id="getMyPosts" resultType="com.tm.nmp.board.PostVO">
		select * from post where post_member = #{post_member} order by post_reg_date desc
	</select>
	
	<select id="getMyDeatailPosts" resultType="com.tm.nmp.board.PostVO">
		select * from post where post_member = #{post_member}
	</select>
	
	
	
	
	
	
</mapper>